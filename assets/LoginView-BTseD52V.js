import{r,u as w,c as b,a as e,w as c,v as d,b as k,d as u,e as v,F as C,f as m,o as x,g as y}from"./index-C_Or6s8U.js";const V={id:"loginPage",class:"bg-yellow"},N={class:"conatiner loginPage vhContainer"},R=e("div",{class:"side"},[e("a",{href:"#"},[e("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),e("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1),T={class:"formControls"},$=e("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1),L=e("label",{class:"formControls_label",for:"email"},"Email",-1),B=e("span",null,"此欄位不可留空",-1),F=e("label",{class:"formControls_label",for:"pwd"},"密碼",-1),P=e("span",null,"密碼長度至少六個字元",-1),S=["disabled"],D={__name:"LoginView",setup(j){const t=r({email:"",password:""});let l=r(!1);const p="https://todolist-api.hexschool.io",_=w(),h=async()=>{const{email:i,password:s}=t.value;if(!i||!s){alert("所有欄位為必填，請確實填寫!");return}l=!0;try{const o=await fetch(`${p}/users/sign_in`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.value)});if(o.ok){const n=await o.json(),{exp:a,token:f,nickname:g}=n;document.cookie=`authTokenCookie=${f}; expires=${a}; path=/ `,document.cookie=`authNickname=${g}; expires=${a}; path=/ `,alert("登入成功"),_.push("/todo")}else switch(o.status){case 400:alert("登入失敗：欄位驗證失敗");break;case 401:alert("登入失敗：帳號密碼驗證錯誤");break;case 404:alert("登入失敗：用戶不存在");break}}catch(o){console.log("error"+o)}finally{l=!1}};return(i,s)=>{const o=m("RouterLink"),n=m("RouterView");return x(),b(C,null,[e("div",V,[e("div",N,[R,e("div",null,[e("form",T,[$,L,c(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.email=a),class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email",required:""},null,512),[[d,t.value.email]]),B,F,c(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.password=a),class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",required:""},null,512),[[d,t.value.password]]),P,e("input",{onClick:h,class:"formControls_btnSubmit",type:"button",value:"登入",disabled:k(l)},null,8,S),u(o,{to:"/signup",class:"formControls_btnLink"},{default:v(()=>[y("註冊帳號")]),_:1})])])])]),u(n)],64)}}};export{D as default};
