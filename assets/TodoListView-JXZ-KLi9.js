import{u as z,g as A,r as f,h as y,c as u,a as e,b as N,d as O,i as r,w as j,v as P,n as v,F as S,j as E,t as p,k as I,e as V,o as d,l as B}from"./index-BIRwpJyb.js";const D={id:"todoListPage",class:"bg-half"},F=e("h1",null,[e("a",{href:"#"},"ONLINE TODO LIST")],-1),M={class:"conatiner todoListPage vhContainer"},R={class:"todoList_Content"},J={class:"inputBox"},U=e("i",{class:"fa fa-plus"},null,-1),q=[U],H={key:0},G={key:1,class:"todoList_list"},K={class:"todoList_tab"},Q={class:"todoList_items"},W={class:"todoList_item"},X={class:"todoList_label"},Y=["onClick","checked"],Z=["onClick"],ee=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),te=[ee],se=["onClick"],oe=e("i",{class:"fa fa-times"},null,-1),ne=[oe],ae={class:"todoList_statistics"},le={key:0},ce={__name:"TodoListView",setup(ie){const l="https://todolist-api.hexschool.io",m=z(),i=document.cookie.replace(/(?:(?:^|.*;\s*)authTokenCookie\s*\=\s*([^;]*).*$)|^.*$/,"$1"),g=document.cookie.replace(/(?:(?:^|.*;\s*)authNickname\s*\=\s*([^;]*).*$)|^.*$/,"$1");A(async()=>{try{(await fetch(`${l}/users/checkout`,{headers:{Authorization:i}})).ok?(alert(`哈囉 ${g}! 開始使用你的代辦清單吧~ `),_()):(alert("已登出或無權使用"),m.push("/login"))}catch(t){console.log(t.message)}});const $=async()=>{try{(await fetch(`${l}/users/sign_out`,{method:"POST",headers:{Authorization:i}})).ok?(alert("登出成功"),m.push("/login")):alert("登出失敗")}catch(t){console.log(t.message)}},c=f([]),h=f(""),_=async()=>{try{const s=await(await fetch(`${l}/todos`,{headers:{Authorization:i}})).json();c.value=s.data}catch(t){console.log(t.message)}},C=async()=>{if(h.value===""){alert("欄位不可空白");return}try{(await fetch(`${l}/todos`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify({content:h.value})})).ok?(_(),h.value="",alert("新增成功"),n.value="all"):alert("新增失敗")}catch(t){console.log(t.message)}},T=async t=>{const s=prompt("請輸入修改內容文字:");if(s===null){alert("取消編輯");return}if(s===""){alert("內容不可空白");return}try{(await fetch(`${l}/todos/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify({content:s})})).ok?(_(),alert("更新成功")):alert("更新失敗")}catch(a){console.log(a.message)}},w=async t=>{try{const s=await fetch(`${l}/todos/${t}`,{method:"DELETE",headers:{Authorization:i}}),a=await s.json();s.ok?(alert(a.message),_()):alert(a.message)}catch(s){console.log(s.message)}},L=async t=>{try{const s=await fetch(`${l}/todos/${t}/toggle`,{method:"PATCH",headers:{Authorization:i}}),a=await s.json();s.ok?(alert(a.message),_()):alert(a.message)}catch(s){console.log(s.message)}},b=y(()=>c.value.filter(t=>t.status===!1).length),n=f("all"),x=y(()=>n.value==="finish"?c.value.filter(t=>t.status===!0):n.value==="unfinish"?c.value.filter(t=>t.status===!1):c.value);return(t,s)=>{const a=V("RouterLink");return d(),u("div",D,[e("nav",null,[F,e("ul",null,[e("li",null,[N(a,{to:"/todo"},{default:O(()=>[e("span",null,p(B(g))+"的代辦",1)]),_:1})]),e("li",null,[e("a",{href:"#",onClick:r($,["prevent"])},"登出")])])]),e("div",M,[e("div",R,[e("div",J,[j(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>h.value=o),type:"text",placeholder:"請輸入待辦事項"},null,512),[[P,h.value]]),e("a",{onClick:r(C,["prevent"]),href:"#"},q)]),c.value.length===0?(d(),u("div",H,"目前尚無待辦事項")):(d(),u("div",G,[e("ul",K,[e("li",null,[e("a",{href:"#",class:v({active:n.value==="all"}),onClick:s[1]||(s[1]=r(o=>n.value="all",["prevent"]))},"全部",2)]),e("li",null,[e("a",{href:"#",class:v({active:n.value==="unfinish"}),onClick:s[2]||(s[2]=r(o=>n.value="unfinish",["prevent"]))},"待完成",2)]),e("li",null,[e("a",{href:"#",class:v({active:n.value==="finish"}),onClick:s[3]||(s[3]=r(o=>n.value="finish",["prevent"]))},"已完成",2)])]),e("div",Q,[e("ul",W,[(d(!0),u(S,null,E(x.value,o=>(d(),u("li",{key:o.id},[e("label",X,[e("input",{class:"todoList_input",type:"checkbox",onClick:k=>L(o.id),checked:o.status},null,8,Y),e("span",null,p(o.content),1)]),e("a",{onClick:r(k=>T(o.id),["prevent"]),href:"#"},te,8,Z),e("a",{onClick:r(k=>w(o.id),["prevent"]),href:"#"},ne,8,se)]))),128))]),e("div",ae,[n.value==="all"?(d(),u("p",le,p(b.value)+"個待完成項目",1)):I("",!0)])])]))])])])}}};export{ce as default};
