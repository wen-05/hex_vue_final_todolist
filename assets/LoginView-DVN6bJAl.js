import{r as c,u as w,c as b,a as e,w as d,v as u,b as k,d as m,e as v,F as C,f as p,o as x,g as y}from"./index-DRrt69UI.js";const V={id:"loginPage",class:"bg-yellow"},$={class:"conatiner loginPage vhContainer"},N=e("div",{class:"side"},[e("a",{href:"#"},[e("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})]),e("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"})],-1),R={class:"formControls"},T=e("h2",{class:"formControls_txt"},"最實用的線上代辦事項服務",-1),L=e("label",{class:"formControls_label",for:"email"},"Email",-1),B=e("span",null,"此欄位不可留空",-1),F=e("label",{class:"formControls_label",for:"pwd"},"密碼",-1),P=e("span",null,"密碼長度至少六個字元",-1),S=["disabled"],D={__name:"LoginView",setup(j){const t=c({email:"",password:""});let l=c(!1);const _="https://todolist-api.hexschool.io",h=w(),f=async()=>{const{email:i,password:s}=t.value;if(!i||!s){alert("所有欄位為必填，請確實填寫!");return}l.value=!0;try{const o=await fetch(`${_}/users/sign_in`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.value)});if(o.ok){const n=await o.json(),{exp:a,token:g,nickname:r}=n;document.cookie=`authTokenCookie=${g}; expires=${a}; path=/ `,document.cookie=`authNickname=${r}; expires=${a}; path=/ `,alert("登入成功"),h.push(`/${r}/todo`)}else switch(o.status){case 400:alert("登入失敗：欄位驗證失敗");break;case 401:alert("登入失敗：帳號密碼驗證錯誤");break;case 404:alert("登入失敗：用戶不存在");break}}catch(o){console.log("error"+o)}finally{l.value=!1}};return(i,s)=>{const o=p("RouterLink"),n=p("RouterView");return x(),b(C,null,[e("div",V,[e("div",$,[N,e("div",null,[e("form",R,[T,L,d(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.email=a),class:"formControls_input",type:"text",id:"email",name:"email",placeholder:"請輸入 email",required:""},null,512),[[u,t.value.email]]),B,F,d(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.password=a),class:"formControls_input",type:"password",name:"pwd",id:"pwd",placeholder:"請輸入密碼",required:""},null,512),[[u,t.value.password]]),P,e("input",{onClick:f,class:"formControls_btnSubmit",type:"button",value:"登入",disabled:k(l)},null,8,S),m(o,{to:"/signup",class:"formControls_btnLink"},{default:v(()=>[y("註冊帳號")]),_:1})])])])]),m(n)],64)}}};export{D as default};
